var com = require("serialport");
var rport = /usb|acm|^com/i;

com.list(function(err, devices) {
  devices.forEach(function(device) {
    var comName = device.comName;
    if (rport.test(comName)) {
      console.log("ATTEMPTING: ", comName);

      var bytes = [];
      var reference = new Buffer("READY");
      var port = new com.SerialPort(comName, {
        baudRate: 9600
      });

      port.on("data", function(data) {
        for (var i = 0; i < data.length; i++) {
          bytes.push(data[i]);
        }

        if (bytes.length === 5) {
          console.log(bytes.toString());
          console.log(reference);
          console.log(bytes);
          console.log(reference.equals(new Buffer(bytes)));
        }
      });

      port.on("open",function() {
        port.write(reference);
      });
    }
  });
});
